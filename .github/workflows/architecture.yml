name: Architecture Visualization

on:
  push:
    branches: [main, develop]
  pull_request:
    branches: [main]
  workflow_dispatch:

concurrency:
  group: architecture-${{ github.ref }}
  cancel-in-progress: true

permissions:
  contents: read

jobs:
  visualize:
    name: Generate & Deploy Architecture Viz
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: sirfifer/solution-explorer@main
        with:
          config: solution-explorer.json
          deploy-to: cloudflare
          cloudflare-api-token: ${{ secrets.CLOUDFLARE_API_TOKEN }}
          cloudflare-account-id: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
          cloudflare-project-name: um-solution-explorer
