#!/bin/bash
# UnaMentis Pre-Push Hook
# This hook runs quick tests before allowing pushes.
# Install with: ./scripts/install-hooks.sh

set -e

# Colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
NC='\033[0m'

echo -e "${YELLOW}Running pre-push checks...${NC}"

# Get the project root
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/../.." && pwd)"

cd "$PROJECT_ROOT"

# Run quick tests
if [ -f "scripts/test-quick.sh" ]; then
    echo -e "\n${YELLOW}Running quick tests...${NC}"
    ./scripts/test-quick.sh || {
        echo -e "${RED}Quick tests failed. Please fix before pushing.${NC}"
        echo -e "${YELLOW}Tip: You can bypass this check with 'git push --no-verify' (not recommended)${NC}"
        exit 1
    }
else
    echo -e "${YELLOW}test-quick.sh not found, skipping tests.${NC}"
fi

echo -e "\n${GREEN}Pre-push checks passed!${NC}"
exit 0
